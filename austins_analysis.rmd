# Analysis of the data by Austin
```{r}
# Import packages
library(tidyverse)
library(ggplot2)
library(GGally)
library(knitr)
library(boot)
library(caret)
```

```{r}
# Load the data
data <- read.csv("breast_cancer_diagnostic_data.csv")
training <- read.csv("training.csv")
test <- read.csv("test.csv")


# Data Cleaning
# Removing the ID column
data <- data[,-1]
test <- test[,-1]
training <- training[,-1]
data$diagnosis <- as.factor(data$diagnosis)
test$diagnosis <- as.factor(test$diagnosis)
training$diagnosis <- as.factor(training$diagnosis)
# Removing the X column from data
data <- data[,1:(length(data)-1)]
# Check for missing values
print(paste(sum(is.na(data)), "missing values in the data"))
# Available variables
print(paste("There are", length(data), "variables available"))
print(names(data))
```

```{r}
# Looking for correlations between variables
g1 <- ggpairs(data, columns = 1:10)
g2 <- ggpairs(data, columns = c(1, 11:20))
g3 <- ggpairs(data, columns = c(1, 21:31))
```

Variables to note: radius_mean, perimeter_worst, area_worst, concave.points_worst

```{r}
# Setting up a binary column for diagnosis
dataBinary <- data
trainingBinary <- training
testBinary <- test
dataBinary$diagnosis_binary <- ifelse(data$diagnosis == "M", 1, 0)
trainingBinary$diagnosis_binary <- ifelse(training$diagnosis == "M", 1, 0)
testBinary$diagnosis_binary <- ifelse(test$diagnosis == "M", 1, 0)
```

```{r}
train_control <- trainControl(method = "cv", number = 10, preProcOptions = list(thresh=0.99), classProbs=TRUE, summaryFunction = twoClassSummary)
```

Random Forrest
```{r}
#Random Forrest
random_forrest <- train(diagnosis ~ ., data = training, method = "ranger", metric="ROC", trControl = train_control, preProcess=c("center", "scale"))
rf_pred <- predict(random_forrest, test)
rf_confusion <- confusionMatrix(rf_pred, test$diagnosis, positive = "M")
print(rf_confusion)

```

KNN
```{r}
#KNN
knn <- train(diagnosis ~ ., data = training, method = "knn", metric="ROC", trControl = train_control)
knn_pred <- predict(knn, test)
knn_confusion <- confusionMatrix(knn_pred, test$diagnosis, positive = "M")
print(knn_confusion)
ggplot(varImp(knn))
varsKNN <- rownames(data.frame(varImp(knn)[1]))[1:10]
```
```

Radial Support Vector Machine
```{r}
#Radial Support Vector Machine
svm <- train(diagnosis ~ ., data = training, method = "svmRadial", trControl = train_control, metric="ROC")
svm_pred <- predict(svm, test)
svm_confusion <- confusionMatrix(svm_pred, test$diagnosis, positive="M")
print(svm_confusion)
ggplot(varImp(svm))
varsSVM <- rownames(data.frame(varImp(svm)[1]))[1:10]
```

```{r}
#Logistic Regression
logistic <- train(diagnosis ~ ., data = training, method = "glm", trControl = train_control, metric="ROC")
logistic_pred <- predict(logistic, test)
logistic_confusion <- confusionMatrix(logistic_pred, test$diagnosis, positive="M")
print(logistic_confusion)
logistic$finalModel
ggplot(varImp(logistic))
varsLOGISTIC <- rownames(data.frame(varImp(logistic)[1]))[1:10]
```

```{r}
logistic2 <- train(diagnosis ~ area_mean + area_worst + concave.points_mean + texture_mean + radius_worst + concavity_se + fractal_dimension_se, data = training, method = "glm", trControl = train_control, metric="ROC")
logistic2_pred <- predict(logistic2, test)
logistic2_confusion <- confusionMatrix(logistic2_pred, test$diagnosis, positive="M")
print(logistic2_confusion)
```

```{r}

```

```{r}
```
